<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bounty Board</title>
    <link rel="stylesheet" href="./CSS/industrial.css">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>

<!-- ===== NAVBAR ===== -->
<header class="navbar">
    <div class="navbar-left">
        <a href="index.html" class="logo">VORTEX BOUNTIES</a>
        <nav>
            <ul>
                <li><a href="index.html">HOME</a></li>
                <li><a href="#">INDUSTRIAL</a></li>
                <li><a href="#">LOGISTICS</a></li>
                <li><a href="#">SCIENCE</a></li>
                <li><a href="#">DEFENSE</a></li>
            </ul>
        </nav>
    </div>
    <div class="navbar-right">
        <a href="https://discord.gg/DuWnazV4" class="icon-link"><img src="./Images/Discord.png" alt="Discord Icon"><span>DISCORD</span></a>
        <a href="#" class="icon-link"><img src="./Images/Youtube.png" alt="YouTube Icon"><span>YOUTUBE</span></a>
        <a href="https://www.twitch.tv/flockersdesign" class="icon-link"><img src="./Images/Twitch.png" alt="Twitch Icon"><span>TWITCH</span></a>
    </div>
</header>

<!-- ===== PLAYER SETUP ===== -->
<section style="padding:100px 20px; text-align:center;">
    <div id="player-setup">
        <h2>Enter your in-game player name:</h2>
        <input type="text" id="playerName" placeholder="Player123">
        <button id="savePlayer">Save</button>
    </div>
</section>

<!-- ===== BOUNTY CARDS ===== -->
<section id="bounty-section" style="display:none; padding: 20px;">
    <h2 class="section-protocol-title">AVAILABLE BOUNTIES</h2>

    <!-- Example Player Bounty Card -->
    <div class="large-content-card">
        <div class="card-header-icon">
            <img src="./Images/Patches/Mining-Operation.png" alt="Bounty Icon" class="card-large-icon">
            <h2>Gendo_dk</h2> <!-- Target player -->
        </div>
        <div class="card-body">
            <p class="card-tagline">Reward: 100.000 SCU</p>
            <p class="card-main-text">This user has killed multiple from our Org so now has a bounty.</p>
            <button class="accept-bounty" data-bounty="Gendo_dk">Accept Bounty</button>
        </div>
    </div>

    <div class="large-content-card">
        <div class="card-header-icon">
            <img src="./Images/Patches/Salvage-recovery.png" alt="Bounty Icon" class="card-large-icon">
            <h2>Starfire_X</h2>
        </div>
        <div class="card-body">
            <p class="card-tagline">Reward: 50.00 SCU</p>
            <p class="card-main-text">Caught raiding our supply routes multiple times.</p>
            <button class="accept-bounty" data-bounty="Starfire_X">Accept Bounty</button>
        </div>
    </div>

        <div class="large-content-card">
        <div class="card-header-icon">
            <img src="./Images/Patches/Salvage-recovery.png" alt="Bounty Icon" class="card-large-icon">
            <h2>MrViking</h2>
        </div>
        <div class="card-body">
            <p class="card-tagline">Reward: 1.000.000 SCU</p>
            <p class="card-main-text">Caught raiding our supply routes multiple times.</p>
            <button class="accept-bounty" data-bounty="Starfire_X">Accept Bounty</button>
        </div>
    </div>
</section>

<script>
// --- PLAYER NAME STORAGE ---
const saveBtn = document.getElementById('savePlayer');
const playerInput = document.getElementById('playerName');
const bountySection = document.getElementById('bounty-section');

saveBtn.addEventListener('click', () => {
    const playerName = playerInput.value.trim();
    if(!playerName) return alert("Enter a player name!");
    localStorage.setItem('playerName', playerName);
    document.getElementById('player-setup').style.display = 'none';
    bountySection.style.display = 'block';
});

// --- MAKE WEBHOOK POST ---
const webhookURL = 'https://hook.eu2.make.com/y25idqg0rqvbj73jyt4udw7o71kal1b4'; // Keep your URL

document.querySelectorAll('.accept-bounty').forEach(btn => {
    btn.addEventListener('click', async () => {
        const acceptingPlayer = localStorage.getItem('playerName'); // The player accepting the bounty
        const targetPlayer = btn.dataset.bounty; // The player on the card

        if(!acceptingPlayer) return alert("No player name set!");

        // *** NEW CODE TO EXTRACT REWARD AND CURRENCY ***
        const targetCard = btn.closest('.large-content-card'); // Find the closest parent card
        const rewardElement = targetCard.querySelector('.card-tagline');
        // Extract text and clean it up (e.g., gets "100.000 UEC" from "Reward: 100.000 UEC")
        const rewardText = rewardElement ? rewardElement.textContent.replace('Reward: ', '').trim() : 'N/A';

        // Update the payload to include the reward
        const payload = {
            acceptingPlayer: acceptingPlayer,
            targetPlayer: targetPlayer,
            reward: rewardText, // e.g., "100.000 UEC"
            timestamp: new Date().toISOString()
        };
        // **********************************

        try {
            const response = await fetch(webhookURL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload) 
            });

            if(response.ok){
                alert(`Bounty "${targetPlayer}" accepted! Reward: ${rewardText}`);
                btn.disabled = true;
                btn.textContent = "Accepted";
            } else {
                console.error("Webhook POST failed", response.status, response.statusText);
                alert("Failed to accept bounty. Check console for errors.");
            }
        } catch(err){
            console.error(err);
            alert("Error sending webhook. Check console for details.");
        }
    });
});
</script>



</body>
</html>
